/** MIT License
* 
* Copyright (c) 2017 Ludovic CLUBER 
* 
* Permission is hereby granted, free of charge, to any person obtaining a copy
* of this software and associated documentation files (the "Software"), to deal
* in the Software without restriction, including without limitation the rights
* to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
* copies of the Software, and to permit persons to whom the Software is
* furnished to do so, subject to the following conditions:
*
* The above copyright notice and this permission notice shall be included in all
* copies or substantial portions of the Software.
*
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
* IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
* FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
* AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
* LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
* OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
* SOFTWARE.
*
* http://mouettejs.lcluber.com
*/

var Mouette=function(e){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var s={info:{id:1,name:"info",color:"#28a745"},time:{id:2,name:"time",color:"#28a745",time:null},trace:{id:3,name:"trace",color:"#17a2b8"},warn:{id:4,name:"warn",color:"#ffc107"},error:{id:5,name:"error",color:"#dc3545"},off:{id:99,name:"off",color:null}},n=function(){function e(e,t,n){this._level="error",this._console=!0,this._maxLength=400,this.level=e||this._level,this.console="boolean"==typeof t?t:this._console,this.maxLength=n||this.maxLength}var t,n,o,i=e.prototype;return i.displayMessage=function(){return this._console},i.checkLevel=function(e){return s[this._level].id<=e},t=e,(n=[{key:"level",set:function(e){this._level=s.hasOwnProperty(e)?e:this._level},get:function(){return this._level}},{key:"console",set:function(e){this._console=!!e},get:function(){return this._console}},{key:"maxLength",set:function(e){this._maxLength=50<e?e:50},get:function(){return this._maxLength}}])&&r(t.prototype,n),o&&r(t,o),e}(),o=function(){function o(e,t,n){this.level=e,this.message=t,this.date=o.formatDate(),this.group=n}var e=o.prototype;return e.display=function(){var e="time"===this.level.name?"info":this.level.name;console[e]("%c["+this.group+"] "+this.date+" : ","color: "+this.level.color+";",this.message)},e.export=function(){return{level:this.level,message:this.message,date:this.date,group:this.group}},o.addZero=function(e){return e<10?"0"+e:e},o.formatDate=function(){var e=new Date,t=[o.addZero(e.getMonth()+1),o.addZero(e.getDate()),e.getFullYear().toString().substr(-2)],n=[o.addZero(e.getHours()),o.addZero(e.getMinutes()),o.addZero(e.getSeconds())];return t.join("/")+" "+n.join(":")},o}(),i=function(e){this.key=e,this.timestamp=(new Date).getTime()},a=function(){function e(e,t){this.name=e,this.logs=[],this.timers=[],this.options=new n(t.level,t.console,t.maxLength)}var t=e.prototype;return t.setLevel=function(e){return this.options.level=e,this.options.level},t.getLevel=function(){return this.options.level},t.displayConsole=function(e){return this.options.console=e,this.options.console},t.setMaxLength=function(e){return this.options.maxLength=e,this.options.maxLength},t.getMaxLength=function(){return this.options.maxLength},t.info=function(e){this.log(s.info,e)},t.trace=function(e){this.log(s.trace,e)},t.time=function(t){var e=this.timers.findIndex(function(e){return e.key===t});if(-1<e){var n=(new Date).getTime()-this.timers[e].timestamp;this.log(Object.assign(Object.assign({},s.time),{time:n}),t+" completed in "+n+" ms"),this.timers.splice(e,1)}else this.addTimer(t),this.log(s.time,t+" started")},t.warn=function(e){this.log(s.warn,e)},t.error=function(e){this.log(s.error,e)},t.resetLogs=function(){this.logs=[]},t.getLogs=function(){var e=[],t=this.logs,n=Array.isArray(t),o=0;for(t=n?t:t[Symbol.iterator]();;){var i;if(n){if(o>=t.length)break;i=t[o++]}else{if((o=t.next()).done)break;i=o.value}var r=i;e.push(r.export())}return e},t.log=function(e,t){if(this.options.checkLevel(e.id)){var n=new o(e,t,this.name);this.addLog(n),this.options.displayMessage()&&n.display()}},t.addLog=function(e){this.logs.length>=this.options.maxLength&&this.logs.shift(),this.logs.push(e)},t.addTimer=function(e){this.timers.length>=this.options.maxLength&&this.timers.shift(),this.timers.push(new i(e))},e}(),t=function(){function e(){}return e.setLevel=function(e){this.options.level=e;var t=this.groups,n=Array.isArray(t),o=0;for(t=n?t:t[Symbol.iterator]();;){var i;if(n){if(o>=t.length)break;i=t[o++]}else{if((o=t.next()).done)break;i=o.value}i.setLevel(this.options.level)}return this.getLevel()},e.getLevel=function(){return this.options.level},e.displayConsole=function(e){this.options.console=e;var t=this.groups,n=Array.isArray(t),o=0;for(t=n?t:t[Symbol.iterator]();;){var i;if(n){if(o>=t.length)break;i=t[o++]}else{if((o=t.next()).done)break;i=o.value}i.displayConsole(this.options.console)}return this.options.console},e.addGroup=function(e){return this.getGroup(e)||this.createGroup(e)},e.sendLogs=function(e,t){var n=this;void 0===t&&(t=new Headers);var o=this.getLogs();if(o.length){t.append("Content-Type","application/json");var i={method:"POST",headers:t,body:JSON.stringify(o)};return fetch(e,i).then(function(e){return e.json()}).then(function(e){return n.resetLogs(),e}).catch(function(e){console.error("Error:",e)})}return null},e.getLogs=function(){var e=[],t=this.groups,n=Array.isArray(t),o=0;for(t=n?t:t[Symbol.iterator]();;){var i;if(n){if(o>=t.length)break;i=t[o++]}else{if((o=t.next()).done)break;i=o.value}var r=i;e.push.apply(e,r.getLogs())}return e},e.resetLogs=function(){var e=this.groups,t=Array.isArray(e),n=0;for(e=t?e:e[Symbol.iterator]();;){var o;if(t){if(n>=e.length)break;o=e[n++]}else{if((n=e.next()).done)break;o=n.value}o.resetLogs()}},e.getGroup=function(e){var t=this.groups,n=Array.isArray(t),o=0;for(t=n?t:t[Symbol.iterator]();;){var i;if(n){if(o>=t.length)break;i=t[o++]}else{if((o=t.next()).done)break;i=o.value}var r=i;if(r.name===e)return r}return null},e.createGroup=function(e){var t=new a(e,this.options);return this.groups.push(t),t},e}();return t.groups=[],t.options=new n,e.Logger=t,e}({});